---
title: "HW 5"
Author: "Kelly Wang, kzw2102"
output: github_document
---

# Problem 1
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(rvest)

set.seed(10)

iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species))
```
* fill in missing numeric values with the mean of the non-missing values
* character variables, fill in missing values with "virginica"


* writing a function that takes a vector as an argument 
* replaces missing values using rules defined above 
* returns the returning vector
* applying this function to the columns of iris_meaning_missing using map statement 

```{r function}
replace_missing = function(x) {
  if (is.character(x)) {
    x=replace(x, is.na(x), "virginica")
  } else {
    mean_x=mean(x, na.rm=TRUE)
    x=replace(x, is.na(x), mean_x)
  }
}

output = map_dfr(iris_with_missing, replace_missing)

```

## Problem 2

```{r}
#TA wise words
data_problem2=tibble(
  files=list.files(path="./data/data"),
  path=str_c("./data/data/",files)
) %>% 
  mutate(data = map(path, read_csv)) %>% 
  unnest()

## change file names to include control arm and subject ID
## make sure weekly observations are tidy
data_problem2_tidy= 
  data_problem2 %>% 
  janitor::clean_names() %>% 
  separate(files, c("control", "experiment")) %>% 
  pivot_longer(
    week_1:week_8,
    names_to="Week",
    names_prefix="week_",
    values_to="Observation"
  ) %>% 
  select(files, Week, Observation) %>% 
  mutate(
    ID = files,
    Arm = files,
    Arm=str_replace(arm,"^exp", "Experiment"),
    Arm=str_replace(arm, "^con", "Control")
  )
    
    ID=str)ID(recode, 'con_01.csv'='1', 'con_02.csv'='2', )
    ID=as.numeric(ID)
    
  )
  
  

```


### Problem 3:
```{r}
sim_regression = function(n, beta0 = 2, beta1 = 3) {
  
  sim_data = tibble(
    x = rnorm(30, mean = 1, sd = 1),
    y = beta0 + beta1 * x + rnorm(n, 0, 1)
  )
  
  ls_fit = lm(y ~ x, data = sim_data)
  
  tibble(
    beta0_hat = coef(ls_fit)[1],
    beta1_hat = coef(ls_fit)[2]
  )
}
```

