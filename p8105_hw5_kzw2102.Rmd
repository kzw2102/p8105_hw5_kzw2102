---
title: "HW 5"
Author: "Kelly Wang, kzw2102"
output: github_document
---

# Problem 1
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(rvest)

set.seed(10)

iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species))
```
* fill in missing numeric values with the mean of the non-missing values
* character variables, fill in missing values with "virginica"


* writing a function that takes a vector as an argument 
* replaces missing values using rules defined above 
* returns the returning vector
* applying this function to the columns of iris_meaning_missing using map statement 

```{r function}
replace_missing = function(x) {
  if (is.character(x)) {
    x=replace(x, is.na(x), "virginica")
  } else {
    mean_x=mean(x, na.rm=TRUE)
    x=replace(x, is.na(x), mean_x)
  }
}

output = map_dfr(iris_with_missing, replace_missing)

```

## Problem 2
```{r}

#tibble with one column to read in list files
problem2_data= tibble(
  list.files(path="./data/data", all.files=FALSE, pattern="*.csv")
) %>% map_df(~read_csv(., col_types=cols(.default="c")))
#function to read in data so that can pull in -- one person per column
reading_files = function(x) {
  read_csv(x) %>% mutate(filename=x)
} 
ouput1=map(problem2_data, reading_files)

reading_csv_map_df <- function(path=".data/data", pattern="*.csv"){
  list.files(path=".data.data", pattern, full.names=TRUE) %>% 
  map_df(~read.csv(., stringAsfactors=FALSE))
} 

output=map(problem2_data, reading_csv_map_df)

## take three
problem2_data=tibble(
  list.files(path="./data/data", pattern="*.csv")
)
list.data<- list()
for (i in 1:length(problem2_data)){
  list.data[[i]] <- read.csv(problem2_data[i])
}
names(list.data)<-list.filenames

### take 4
problem2_data_path=tibble(
  list.files(path="./data/data", pattern="*.csv")
)
data_2=problem2_data_path %>% 
  mutate(file_contents=map(problem2_data, ~read_csv(file.path("./data/data",.))))
data_2


### take 5 

# create a path for each file
problem2_data= tibble(
  list.files(path="./data/data", all.files=FALSE, pattern="*.csv", full.names=TRUE) %>% mutate(
    filenames=list.files(path="./data/data", all.files=FALSE, pattern="*.csv", full.names=TRUE)
  )

reading_files = function(x) {
  x=read_csv(x)
} 
vec_data=str_c(problem2_data, 1:length(problem2_data))

output=vector("list", length(problem2_data))

for (i in 1:length(problem2_data)){
  output[[i]]=reading_files(vec_data[[i]])
}

data_problem2=bind_rows(output)

data_problem2=map_df(, reading_files)

#Take 6:
data_problem2=tibble(
  files=list.files(path="./data/data", full.names=TRUE),
    path=str_c("./data/data",files)
)
problem2_data=map_df(data_problem2, read_csv)
reading_files=function(x){
  files=list.files(path="./data/data", full.names=TRUE) %>% 
    path=str_c("./data/data",files)
  gsub(pattern=".csv$", replacement="")
}

problem2_data=map_df(list.files(path="./data/data", full.names=TRUE), rbind, reading_files, col_names=FALSE, .id="input")

problem2_data= tibble(
  list.files(path="./data/data", all.files=FALSE, pattern="*.csv", full.names=TRUE) 

```

```{r}
#TA wise words
data_problem2=tibble(
  files=list.files(path="./data/data"),
  path=str_c("./data/data/",files)
) %>% 
  mutate(data = map(path, read_csv)) %>% 
  unnest()

```


### Problem 3:
```{r}
sim_regression = function(n, beta0 = 2, beta1 = 3) {
  
  sim_data = tibble(
    x = rnorm(30, mean = 1, sd = 1),
    y = beta0 + beta1 * x + rnorm(n, 0, 1)
  )
  
  ls_fit = lm(y ~ x, data = sim_data)
  
  tibble(
    beta0_hat = coef(ls_fit)[1],
    beta1_hat = coef(ls_fit)[2]
  )
}
```

